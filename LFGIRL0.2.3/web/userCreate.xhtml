<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
        xmlns:p="http://primefaces.org/ui"
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <!--The Account creation page, check for empty fields, incorrect email format, and 
      existing usernames @ yawei-->
    <h:head>
        <title>User Creation</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    </h:head>
    <h:body>
        <h:form>
            <!--replace the plain text labels with I18n property tags later-->
            <!--3 columns, the last column is for the message after the textbox-->
            <!--Email regrex obtained from http://regexlib.com/Search.aspx?k=email&AspxAutoDetectCookieSupport=1 -->
            <p:spacer height="20"/>
            <h2>Account Creation</h2>   
                <h:panelGrid id="userCreationPanel" columns="3" cellpadding="5">                
                  <h:outputLabel for="usernameEntry" value="Enter Username:" />
                  <p:inputText id="usernameEntry" value="#{userName}" label="usernameEntry"  required="true"
                  requiredMessage="Please enter username"/>
                  <h:message for="usernameEntry" style="color: red;"/>                           
                                        
                  <h:outputLabel for="passwordEntry" value="Enter Password:"/>
                  <p:password id="passwordEntry" value="#{password}" label="passwordEntry" required="true"
                   requiredMessage="Please enter the password"  match="passwordConfirm">
                    <!--using 'match' to validate password, part of primefaces-->
                  </p:password>
                  <h:message for="passwordEntry" style="color: red;"/>
                
                  <h:outputLabel for="passwordConfirm" value="Confirm Password:" />
                  <p:password id="passwordConfirm" value="#{passwordConfirm}" label="passwordConfirm" required="true"
                    requiredMessage="Please confirm the password"/>
                  <h:message for="passwordConfirm" style="color: red;"/>
                
                  <h:outputLabel for="emailEntry" value="Enter Email:" />
                  <p:inputText id="emailEntry" value="#{email}" label="emailEntry" required="true"
                     requiredMessage="Please enter your email address" 
                     validatorMessage="Incorrect email format, please try again">
                  <f:validateRegex pattern="^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$"/>
                  </p:inputText>
                  <h:message for="emailEntry" style="color: red;"/>
                             
                  <p:commandButton id="updateInfo" value="Create Account" update="userCreationPanel" 
                             action="#{UsersView.addUser(userName, password, email)}"></p:commandButton>   
                             
                 <!--dialogs for success or failure -->
                <p:dialog header="Can't Create Account" widgetVar="signUpFailDlg" minHeight="60">
                   <h:outputText value="Username already exists, please choose a different one."/>
                </p:dialog>
                 
                <p:dialog header="Can't Create Account" widgetVar="emailFailDlg" minHeight="60">
                   <h:outputText value="This Email has been associated with another account, please choose a different one."/>
                </p:dialog>
        
               <p:dialog header="Account Created" widgetVar="signUpSuccessDlg" minHeight="60">
                  <h:outputText value="Welcome, please enjoy your stay"/>
               </p:dialog>               
            </h:panelGrid>           
        </h:form>       
    </h:body>
</html>
